<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stock Graph Viewer</title>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>

<h1>Stock Graph Viewer</h1>

<select id="stockSelect">
  <option value="AAPL">Apple Inc. (AAPL)</option>
  <option value="GOOG">Alphabet Inc. (GOOG)</option>
  <option value="MSFT">Microsoft Corporation (MSFT)</option>
</select>

<div id="plot"></div>

<script>
document.getElementById("stockSelect").addEventListener("change", function() {
  var symbol = this.value;
  fetchYahooCSV(symbol, plotGraph);
});

function fetchYahooCSV(symbol, callback) {
  var file = "data/" + symbol + ".csv"; // Assuming the files are in a 'data' folder
  fetch(file)
    .then(response => response.text())
    .then(csv => {
      callback(csv);
    })
    .catch(error => console.error('Error:', error));
}

function plotGraph(csv) {
  var lines = csv.split("\n");
  var data = [];
  for (var i = 1; i < lines.length; i++) {
    var parts = lines[i].split(",");
    if (parts.length >= 6) {
      var date = parts[0];
      var close = parseFloat(parts[4]);
      data.push({x: date, y: close});
    }
  }
  var layout = {
    title: 'Stock Price History',
    xaxis: {
      title: 'Date'
    },
    yaxis: {
      title: 'Closing Price (USD)'
    }
  };
  var config = {responsive: true};
  Plotly.newPlot('plot', [{x: data.map(d => d.x), y: data.map(d => d.y), type: 'scatter', mode: 'lines'}], layout, config);
}

// Initial load
fetchYahooCSV("AAPL", plotGraph);

</script>

</body>
</html>
